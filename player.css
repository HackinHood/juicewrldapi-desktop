*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:#121212;color:#fff;overflow:hidden}
.player-app{display:grid;grid-template-columns:260px 1fr;grid-template-rows:1fr;height:100vh;padding-top:36px}
.titlebar{position:fixed;top:0;left:0;right:0;height:36px;background:#111214;color:#fff;display:grid;grid-template-columns:1fr auto 1fr;align-items:center;padding:6px 8px;z-index:1000}
.titlebar-drag{-webkit-app-region:drag;height:100%}
.titlebar-center{display:flex;justify-content:center;align-items:center;gap:8px;-webkit-app-region:no-drag}
.titlebar-title{font-size:12px;opacity:.9}
.titlebar-right{display:flex;align-items:center;justify-content:flex-end;height:100%}
.titlebar-controls{display:flex;gap:6px;justify-content:flex-end;-webkit-app-region:no-drag}
.is-mac .titlebar-controls{display:none}
.titlebar+.sidebar{border-top:1px solid #1f1f1f}
.tb-btn{background:#1f1f1f;border:1px solid #2a2a2a;color:#ddd;width:28px;height:22px;border-radius:4px;cursor:pointer;font-size:11px;line-height:20px;padding:0}
.tb-btn:hover{background:#2a2a2a}
.tb-btn.close{color:#ddd;background:#1f1f1f;border-color:#2a2a2a}
.tb-btn.close:hover{color:#fff;background:#d83b2f;border-color:#d83b2f}
.sidebar{background:#000;display:flex;flex-direction:column;gap:16px;padding:16px}
.brand{display:flex;align-items:center;gap:12px;cursor:pointer}
.brand img{width:32px;height:32px;border-radius:6px}
.nav{display:flex;flex-direction:column;gap:8px}
.nav-btn{background:transparent;border:1px solid #222;color:#ddd;text-align:left;padding:10px 12px;border-radius:8px;cursor:pointer}
.nav-btn.active,.nav-btn:hover{background:#1f1f1f;border-color:#333}
.content{background:linear-gradient(180deg,#1f1f1f 0%,#111 60%);position:relative;display:flex;flex-direction:column;min-height:0}
.topbar{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;position:sticky;top:0;background:rgba(17,17,17,.9);backdrop-filter:blur(6px);z-index:5}
.search{display:flex;align-items:center;gap:8px;background:#2a2a2a;border-radius:20px;padding:6px 12px;width:360px}
.search input{background:transparent;border:none;outline:none;color:#fff;width:100%}
.actions .btn{background:#2a2a2a;border:1px solid #333;color:#ddd;padding:8px 10px;border-radius:8px;cursor:pointer}
.library{padding:16px;display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:20px;overflow:auto;height:auto;flex:1;min-height:0;align-content:start;padding-bottom:120px;scroll-behavior:smooth}
.library::-webkit-scrollbar{height:12px;width:12px}
.library::-webkit-scrollbar-track{background:#141414;border-radius:10px}
.library::-webkit-scrollbar-thumb{background:linear-gradient(180deg,#2a2a2a,#3a3a3a);border-radius:10px;border:2px solid #141414}
.library::-webkit-scrollbar-thumb:hover{background:linear-gradient(180deg,#343434,#474747)}
.section-title{grid-column:1/-1;font-size:1.2rem;color:#fff;margin:12px 0 16px 0;font-weight:600}
.row{grid-column:1/-1;display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:20px;margin-bottom:24px}
.card{background:#181818;border:1px solid #262626;border-radius:12px;padding:16px;display:flex;flex-direction:column;gap:12px;cursor:pointer;transition:all 0.2s ease;min-height:280px}
.card:hover{background:#222;transform:translateY(-2px);box-shadow:0 8px 25px rgba(0,0,0,0.3)}
.thumb{width:100%;aspect-ratio:1/1;background:#333;border-radius:8px;display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}
.thumb video{width:100%;height:100%;object-fit:cover}
.thumb img{width:100%;height:100%;object-fit:cover}
.title{font-weight:600;font-size:1rem;color:#fff;line-height:1.3;margin-bottom:4px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.subtitle{color:#aaa;font-size:.85rem;line-height:1.2;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.pill{display:inline-flex;align-items:center;gap:6px;background:#1db954;border:none;color:#000;border-radius:20px;padding:8px 12px;font-size:.8rem;cursor:pointer;font-weight:600;transition:all 0.2s ease;margin-top:auto}
.pill:hover{background:#1ed760;transform:scale(1.05)}
.grid-compact{grid-template-columns:repeat(auto-fill,minmax(180px,1fr))}
.grid-compact .card{min-height:240px;padding:14px}
.grid-compact .thumb{aspect-ratio:1/1}
.grid-compact .title{font-size:.95rem}
.grid-compact .subtitle{font-size:.8rem}
.collection-header{grid-column:1/-1;display:flex;align-items:flex-end;justify-content:space-between;margin:8px 0 12px 0}
.collection-actions{grid-column:1/-1;display:flex;gap:12px;align-items:center;margin:0 0 12px 0}
.collection-grid{grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:16px}
.playlist-actions{grid-column:1/-1;display:flex;gap:8px;align-items:center;margin-bottom:12px}
.pill.secondary{background:#2a2a2a;border:1px solid #333;color:#ddd}
.pill.secondary:hover{background:#333}
.queue-toggle{position:fixed;right:20px;bottom:96px;z-index:1100;background:#1db954;color:#000;border:none;border-radius:20px;padding:10px 14px;font-weight:600;cursor:pointer}
.queue-panel{position:fixed;right:20px;bottom:96px;width:360px;max-height:50vh;overflow:auto;background:#181818;border:1px solid #262626;border-radius:12px;box-shadow:0 8px 25px rgba(0,0,0,0.4);z-index:1100;display:none}
.history-panel{position:fixed;right:20px;bottom:96px;width:360px;max-height:50vh;overflow:auto;background:#181818;border:1px solid #262626;border-radius:12px;box-shadow:0 8px 25px rgba(0,0,0,0.4);z-index:1100;display:none}
.rooms-panel{position:fixed;right:20px;top:52px;width:380px;max-height:60vh;overflow:auto;background:linear-gradient(180deg,#1b1b1b 0%,#121212 100%);border:1px solid #2b2b2b;border-radius:14px;box-shadow:0 10px 30px rgba(0,0,0,0.45);z-index:1100;display:none}
.rooms-panel::-webkit-scrollbar{width:10px}
.rooms-panel::-webkit-scrollbar-track{background:#141414;border-radius:10px}
.rooms-panel::-webkit-scrollbar-thumb{background:#2f2f2f;border-radius:10px;border:2px solid #141414}
.rooms-panel::-webkit-scrollbar-thumb:hover{background:#3a3a3a}
.queue-header{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;border-bottom:1px solid #262626;font-weight:600}
.queue-header .btn{background:#242424;border:1px solid #343434;color:#e5e5e5;padding:8px 12px;border-radius:8px;cursor:pointer;display:inline-flex;align-items:center;gap:6px;transition:all .15s ease}
.queue-header .btn:hover{background:#2f2f2f;transform:translateY(-1px)}
.queue-list{padding:8px 8px 10px 8px;display:flex;flex-direction:column;gap:8px}
.history-list{padding:8px 8px 10px 8px;display:flex;flex-direction:column;gap:8px}
.queue-item{display:flex;align-items:center;gap:8px;background:#202020;border:1px solid #2a2a2a;border-radius:8px;padding:8px}
.history-item{display:flex;align-items:center;gap:8px;background:#202020;border:1px solid #2a2a2a;border-radius:8px;padding:8px}
.queue-item .qi-meta{flex:1;min-width:0}
.queue-item .qi-title{font-size:.95rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.queue-item .qi-sub{font-size:.8rem;color:#aaa;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.queue-actions{display:flex;gap:6px}
.queue-actions .btn{background:#2a2a2a;border:1px solid #333;color:#ddd;padding:6px 8px;border-radius:6px;cursor:pointer}
.context-menu{position:fixed;z-index:1200;background:#181818;border:1px solid #2a2a2a;border-radius:8px;overflow:hidden;display:none;min-width:160px}
.context-menu button{display:block;width:100%;text-align:left;background:transparent;border:none;color:#ddd;padding:10px 12px;cursor:pointer}
.context-menu button:hover{background:#262626}
.queue-item.active{border-color:#1db954;background:#1a2a1a}
.modal-overlay{position:fixed;left:0;right:0;top:0;bottom:0;background:rgba(0,0,0,.55);display:none;align-items:center;justify-content:center;z-index:2000}
.modal{background:#181818;border:1px solid #262626;border-radius:12px;box-shadow:0 12px 40px rgba(0,0,0,.6);padding:16px;min-width:320px;max-width:420px}
.modal h4{margin:0 0 8px 0;font-size:1.05rem}
.modal p{margin:0 0 12px 0;color:#aaa;font-size:.9rem}
.modal-actions{display:flex;justify-content:flex-end;gap:8px}
.modal .btn{background:#2a2a2a;border:1px solid #333;color:#ddd;padding:8px 12px;border-radius:6px;cursor:pointer}
.modal .btn:hover{background:#333}
.modal .btn.danger{background:#c42b1c;border-color:#c42b1c;color:#fff}
.modal .btn.danger:hover{background:#d83b2f;border-color:#d83b2f}
.modal select,.modal input[type="text"]{background:#1e1e1e;border:1px solid #303030;color:#eaeaea;border-radius:10px;padding:10px 12px;width:100%;box-shadow:inset 0 1px 0 rgba(255,255,255,.04)}
.modal input[type="text"]::placeholder{color:#9a9a9a}
.modal input[type="text"]:focus{outline:none;border-color:#1db954;box-shadow:0 0 0 3px rgba(29,185,84,.25)}
.modal label{display:block;color:#aaa;font-size:.85rem;margin:8px 0 6px 0}
.playlist-form{display:flex;flex-direction:column;gap:8px;margin-bottom:8px}
.player-bar{grid-column:1/3;background:#181818;border-top:1px solid #262626;height:96px;display:flex;align-items:center;justify-content:space-between;padding:14px 16px;gap:16px;position:fixed;left:0;right:0;bottom:0;z-index:1000}
.track-info{display:flex;align-items:center;gap:12px;min-width:0}
.track-info img{width:48px;height:48px;border-radius:6px}
.controls{display:grid;align-items:center;gap:12px;flex:1;justify-content:center;grid-template-columns:auto auto auto auto minmax(160px,1fr)}
.icon{background:#2a2a2a;border:1px solid #333;color:#ddd;width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;position:relative}
.icon.primary{background:#1db954;border:1px solid #1db954;color:#000}
.icon.active{background:#1db954;border:1px solid #1db954;color:#000}
.repeat-one-indicator{position:absolute;top:-8px;left:50%;transform:translateX(-50%);font-size:12px;font-weight:900;line-height:1;color:#1db954;background:#000;border-radius:50%;width:18px;height:18px;display:flex;align-items:center;justify-content:center;border:2px solid #1db954}
.seek{display:flex;align-items:center;gap:8px;min-width:0}
.seek input{width:100%;margin:0}
.volume{display:flex;align-items:center;gap:8px;min-width:0}
.volume input{margin:0}
.volume #queueBtn{background:#1db954;border:1px solid #1db954;color:#000}
.volume #queueBtn:hover{background:#1ed760;border-color:#1ed760}
.hidden{display:none}

.icon.favorited i{color:#FFD700}

.video-container {
    position: fixed;
    top: 36px;
    left: 240px;
    right: 0;
    bottom: 80px;
    background: #000;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 100;
}

.video-container.hidden {
    display: none;
}

.video-container video {
    max-width: 100%;
    max-height: 100%;
    width: auto;
    height: auto;
    object-fit: contain;
}

.library.video-mode {
    display: none;
}

.video-pip {
    position: fixed;
    bottom: 100px;
    right: 20px;
    width: 320px;
    height: 180px;
    background: #000;
    border-radius: 8px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.5);
    z-index: 1000;
    overflow: hidden;
    cursor: move;
    user-select: none;
    transition: transform 0.2s ease;
}

.video-pip.hidden {
    display: none;
}

.pip-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 12px;
    background: #333;
    color: #fff;
    font-size: 0.85rem;
    font-weight: 500;
}

.pip-title {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    flex: 1;
}

.pip-controls {
    display: flex;
    gap: 4px;
}

.pip-btn {
    background: transparent;
    border: none;
    color: #ccc;
    width: 24px;
    height: 24px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 0.8rem;
}

.pip-btn:hover {
    background: #555;
    color: #fff;
}

.video-pip video {
    width: 100%;
    height: calc(100% - 40px);
    object-fit: cover;
}

.video-pip.dragging {
    cursor: grabbing;
    transform: scale(1.05);
    box-shadow: 0 8px 30px rgba(0,0,0,0.7);
}


.volume input{width:clamp(80px,18vw,160px)}
.player-bar .title{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.player-bar .subtitle{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

.fav-toggle{position:absolute;top:8px;right:8px;background:rgba(0,0,0,.6);border:1px solid #333;color:#ddd;width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer}
.fav-toggle:hover{background:rgba(0,0,0,.75)}
.fav-toggle .fa-star{color:#FFD700}

@media (max-width: 1200px){
  .controls{grid-template-columns:auto auto auto minmax(120px,1fr)}
}

@media (max-width: 900px){
  .player-bar{display:grid;grid-template-columns:1fr auto;grid-template-rows:auto auto;grid-template-areas:"info volume" "controls controls";height:auto;row-gap:10px}
  .track-info{grid-area:info}
  .controls{grid-area:controls;justify-content:center;grid-template-columns:auto auto auto;grid-template-rows:auto auto}
  .controls .seek{grid-column:1/-1}
  .volume{grid-area:volume;justify-self:end}
}

@media (max-width: 600px){
  .track-info img{width:40px;height:40px}
  .player-bar .subtitle{display:none}
  .icon{width:32px;height:32px}
  .volume input{width:clamp(60px,22vw,120px)}
}
